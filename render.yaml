services:
  - type: web
    name: pizzaria-pos
    env: docker
    plan: free
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: "prod"
      # --- FIX ---
      # The URL should NOT contain the user or password
      - key: SPRING_DATASOURCE_URL
        value: "jdbc:postgresql://aws-1-us-east-1.pooler.supabase.com:5432/postgres"
      # These variables will be correctly combined with the URL by Spring
      - key: SPRING_DATASOURCE_USERNAME
        value: "postgres.chxbzrurehvppgqlynfa"
      - key: SPRING_DATASOURCE_PASSWORD
        value: "HootyHoo28!"
      - key: SPRING_JPA_HIBERNATE_DDL_AUTO
        value: "update"
      # --- RECOMMENDED ADDITION ---
      # Limits your app's connection pool to 5 to work with Supabase's free tier
      - key: SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE
        value: 5
